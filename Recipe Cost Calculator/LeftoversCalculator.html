<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Serving Size Converter</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #1a202c;
      color: #cbd5e0;
    }
    .container {
      max-width: 100%;
    }
    .dark-input {
      background-color: #2d3748;
      color: #cbd5e0;
      border: 1px solid #4a5568;
    }
  </style>
</head>
<body class="bg-gray-900 text-gray-200">
  <div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mb-6 text-center">Serving Size Converter</h1>

    <div class="bg-gray-800 p-6 rounded-lg shadow-lg mb-6">
      <h2 class="text-xl font-bold mb-4">Usage Instructions</h2>
      <p class="mb-2">Use this calculator to convert ingredient quantities between different serving sizes. Simply input the original number of servings and the desired number of servings, then add the ingredients along with their quantities and units. Click "Convert" to get the adjusted quantities.</p>
      <p class="mb-4">You can add or remove ingredients as needed. The converted list of ingredients can be downloaded as a PDF for easy reference.</p>
    </div>

    <div class="bg-gray-800 p-6 rounded-lg shadow-lg mb-6">
      <div class="mb-4">
        <label for="originalServings" class="block text-sm font-medium text-gray-400">Original Number of Servings</label>
        <small class="text-gray-500">Enter the number of servings for the original recipe.</small>
        <input type="number" id="originalServings" class="dark-input mt-1 block w-full p-2 rounded-md" min="1">
      </div>

      <div class="mb-4">
        <label for="newServings" class="block text-sm font-medium text-gray-400">New Number of Servings</label>
        <small class="text-gray-500">Enter the desired number of servings for the adjusted recipe.</small>
        <input type="number" id="newServings" class="dark-input mt-1 block w-full p-2 rounded-md" min="1">
      </div>

      <div id="ingredientList" class="mb-4"></div>

      <div class="flex gap-3">
        <button id="addIngredient" class="w-1/2 bg-blue-600 text-white px-4 py-2 rounded-md">Add Ingredient</button>
      <button id="convert" class="w-1/2 bg-green-600 text-white px-4 py-2 rounded-md ml-2">Convert</button>
      </div>
    </div>

    <h2 class="text-2xl font-bold mb-4">Converted Ingredients</h2>
    <div id="convertedList" class="bg-gray-800 p-6 rounded-lg shadow-lg mb-6"></div>
    
    <button id="downloadPDF" class="w-full bg-red-600 text-white px-4 py-2 rounded-md">Download PDF</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/pdfmake@0.1.70/build/pdfmake.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdfmake@0.1.70/build/vfs_fonts.js"></script>
  <script>
    document.getElementById('addIngredient').addEventListener('click', function() {
      const ingredientList = document.getElementById('ingredientList');
      const ingredientDiv = document.createElement('div');
      ingredientDiv.className = 'mb-4 flex space-x-2';

      const ingredientName = document.createElement('input');
      ingredientName.type = 'text';
      ingredientName.placeholder = 'Ingredient Name';
      ingredientName.className = 'sm:flex-grow block  p-2 rounded-md dark-input';
      ingredientName.setAttribute('aria-label', 'Ingredient Name');
      ingredientName.setAttribute('title', 'Enter the name of the ingredient');

      const ingredientQuantity = document.createElement('input');
      ingredientQuantity.type = 'number';
      ingredientQuantity.placeholder = 'Quantity';
      ingredientQuantity.className = 'sm:flex-grow block p-2 rounded-md dark-input';
      ingredientQuantity.setAttribute('aria-label', 'Quantity');
      ingredientQuantity.setAttribute('title', 'Enter the quantity of the ingredient for the original recipe');

      const ingredientUnit = document.createElement('input');
      ingredientUnit.type = 'text';
      ingredientUnit.placeholder = 'Unit (e.g., cups, grams)';
      ingredientUnit.className = 'sm:flex-grow block p-2 rounded-md dark-input';
      ingredientUnit.setAttribute('aria-label', 'Unit');
      ingredientUnit.setAttribute('title', 'Enter the unit of measurement for the ingredient');

      const removeButton = document.createElement('button');
      removeButton.textContent = 'Remove';
      removeButton.className = 'bg-red-600 text-white px-4 py-2 rounded-md';
      removeButton.addEventListener('click', () => ingredientDiv.remove());

      ingredientDiv.appendChild(ingredientName);
      ingredientDiv.appendChild(ingredientQuantity);
      ingredientDiv.appendChild(ingredientUnit);
      ingredientDiv.appendChild(removeButton);

      ingredientList.appendChild(ingredientDiv);
    });

    document.getElementById('convert').addEventListener('click', function() {
      const originalServings = document.getElementById('originalServings').value;
      const newServings = document.getElementById('newServings').value;
      const ingredientList = document.getElementById('ingredientList').children;
      const convertedList = document.getElementById('convertedList');
      convertedList.innerHTML = '';

      for (let ingredientDiv of ingredientList) {
        const name = ingredientDiv.children[0].value;
        const quantity = ingredientDiv.children[1].value;
        const unit = ingredientDiv.children[2].value;

        const newQuantity = (quantity * newServings / originalServings).toFixed(2);
        const convertedIngredient = document.createElement('div');
        convertedIngredient.textContent = `${name}: ${newQuantity} ${unit}`;
        convertedList.appendChild(convertedIngredient);
      }

      generatePDF();
    });

    document.getElementById('downloadPDF').addEventListener('click', generatePDF);

    function generatePDF() {
      const originalServings = document.getElementById('originalServings').value;
      const newServings = document.getElementById('newServings').value;
      const convertedList = document.getElementById('convertedList').children;

      const docDefinition = {
        content: [
          { text: 'Serving Size Converter', style: 'header' },
          { text: `Original Servings: ${originalServings}`, margin: [0, 10, 0, 5] },
          { text: `New Servings: ${newServings}`, margin: [0, 5, 0, 10] },
          { text: 'Converted Ingredients:', style: 'subheader' },
          ...Array.from(convertedList).map(ingredient => ({ text: ingredient.textContent })),
        ],
        styles: {
          header: {
            fontSize: 18,
            bold: true,
            margin: [0, 0, 0, 10]
          },
          subheader: {
            fontSize: 14,
            bold: true,
            margin: [0, 10, 0, 5]
          }
        }
      };

      pdfMake.createPdf(docDefinition).download('Serving_Size_Converter.pdf');
    }
  </script>
</body>
</html>
